from pyqcm import *
new_cluster_model('clus', 12, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [2, 0, 0], [3, 0, 0], [0, 1, 0], [1, 1, 0], [2, 1, 0], [3, 1, 0], [0, 2, 0], [1, 2, 0], [2, 2, 0], [3, 2, 0]], ref = 0)
lattice_model('model_3x4_n12_U1e-09', [[4, 0, 0], [1, 3, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N12:S0'])
set_parameters("""

                U = 1e-09
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 0.000000001
                """)
set_parameter("U", 1e-09)
set_parameter("mu", 1e-09)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1e-09
mu	1e-09
t	1
tp	-0.3
tpp	0.2

GS_energy: -17.676 GS_sector: R0:N12:S0:1
GF_format: bl
mixing	0
state
R0:N12:S0	-17.676	1
w	12	12
-0.75541300807324	0.15932295846825	-0.32498761669836	0.3249876166983	-0.15932295846822	0.21747080827508	-0.43669776200885	0.43669776200884	-0.21747080827502	0.15932295846824	-0.32498761669834	0.32498761669832	-0.15932295846822
-0.97759030564012	-0.30168600999862	0.20325070203404	0.20325070203407	-0.30168600999871	-0.393273419128	0.28405179949238	0.28405179949245	-0.39327341912799	-0.30168600999863	0.20325070203406	0.20325070203405	-0.30168600999869
-1.1646603267604	-0.17455907263669	-0.27869993438939	-0.27869993438929	-0.17455907263698	0.29841116738068	0.44120486017898	0.44120486017913	0.29841116738035	-0.17455907263678	-0.27869993438952	-0.27869993438944	-0.17455907263706
-1.600000000523	0.27735009812357	0.41602514716179	0.41602514716199	0.27735009812317	0	0	0	0	-0.27735009812257	-0.41602514716219	-0.41602514716203	-0.27735009812305
-1.703991941442	-0.33013646813015	-0.16361478647713	0.16361478647716	0.33013646813015	-0.42892088050526	-0.21096707416038	0.21096707416039	0.42892088050523	-0.33013646813016	-0.16361478647714	0.16361478647714	0.33013646813013
-2.6363301829524	-0.21472401245644	-0.30962975266084	-0.30962975266072	-0.21472401245677	-0.26594515691081	-0.38120755894788	-0.38120755894771	-0.26594515691123	-0.21472401245646	-0.30962975266087	-0.30962975266074	-0.21472401245677
-0.2433981137936	0.43732124063114	0.24238426618267	-0.24238426618261	-0.43732124063113	0	0	0	0	-0.43732124063114	-0.24238426618265	0.24238426618258	0.43732124063118
0.61436181072337	0.29326048484453	0.16788391951547	-0.16788391951564	-0.29326048484423	-0.45132088773433	-0.26064537496065	0.26064537496056	0.45132088773442	0.29326048484424	0.1678839195158	-0.16788391951561	-0.29326048484453
0.99999999942229	-0.41602514716179	0.27735009812334	0.27735009812279	-0.41602514716212	0	0	0	0	0.41602514716211	-0.27735009812317	-0.27735009812299	0.4160251471619
1.6433981126929	0.24238426618256	-0.4373212406309	0.43732124063107	-0.2423842661828	0	0	0	0	-0.24238426618257	0.437321240631	-0.43732124063104	0.24238426618264
2.3785808134536	-0.28706842390928	0.18746977079322	0.18746977079354	-0.28706842390881	0.43076671935708	-0.28166228636528	-0.28166228636543	0.43076671935677	-0.28706842390899	0.18746977079342	0.18746977079331	-0.28706842390906
3.445043136893	-0.17211738826814	0.29904554871618	-0.29904554871617	0.17211738826812	0.25503486449771	-0.44368000494541	0.44368000494549	-0.25503486449782	-0.17211738826832	0.29904554871587	-0.29904554871598	0.17211738826848

"""
read_cluster_model_instance(solution[0], 0)
