from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n2_U2', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N2:S0'])
set_parameters("""

            U = 2.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 2.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	2
t	1
tp	-0.3

GS_energy: -3.06026 GS_sector: R0:N2:S0:1
GF_format: bl
mixing	0
state
R0:N2:S0	-3.06026	1
w	4	20
-1.3602643008685	0.49026578753819	0.49026578753819	0.49026578753819	0.49026578753819
-2.7602643008685	0.0072909139951424	-0.095464764688215	0.095464764688215	-0.0072909139951422
-2.7602643008685	-0.095464764688216	-0.0072909139951424	0.0072909139951422	0.095464764688215
-5.3602643008685	-0.021743478233598	0.021743478233598	0.021743478233598	-0.021743478233597
0.12528614551266	-0.61099231542162	-0.32213407845806	0.32213407845806	0.61099231542162
0.12528614551266	-0.32213407845806	0.61099231542162	-0.61099231542162	0.32213407845806
1.6802882677772	0.28535066048414	-0.28535066048414	-0.28535066048414	0.28535066048414
2.0693311465497	-0.089949669433512	-0.089949669433512	-0.089949669433512	-0.089949669433512
2.9298406674878	0.0066372223950113	-0.036570522889785	0.036570522889785	-0.0066372223950115
2.9298406674878	-0.036570522889785	-0.0066372223950114	0.0066372223950115	0.036570522889785
3.3649096283003	0.40997571705227	-0.40997571705227	-0.40997571705227	0.40997571705227
4.8666398251257	-0.065500109863995	-0.05534175660878	0.055341756608779	0.065500109863996
4.8666398251257	-0.05534175660878	0.065500109863996	-0.065500109863995	0.05534175660878
5.1212808030185	0.047493780024192	-0.052531252406143	0.052531252406143	-0.047493780024192
5.1212808030185	-0.052531252406144	-0.047493780024192	0.047493780024192	0.052531252406144
5.9883751945279	-0.029912659541914	-0.029912659541914	-0.029912659541913	-0.029912659541914
6.435595006528	0.0047045874466857	-0.0047045874466858	-0.0047045874466858	0.004704587446686
7.4230865615279	-0.025568483284842	-0.025568483284842	-0.025568483284842	-0.025568483284842
8.558274063198	0.00050051106511099	0.0012144356236251	-0.0012144356236251	-0.00050051106511094
8.558274063198	-0.0012144356236253	0.0005005110651111	-0.00050051106511096	0.0012144356236252

"""
read_cluster_model_instance(solution[0], 0)
