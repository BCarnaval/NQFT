from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n2_U1', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N2:S0'])
set_parameters("""

            U = 1.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 1.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1
t	1
tp	-0.3

GS_energy: -3.19587 GS_sector: R0:N2:S0:1
GF_format: bl
mixing	0
state
R0:N2:S0	-3.19587	1
w	4	20
-1.495865421014	-0.49676819737803	-0.49676819737803	-0.49676819737803	-0.49676819737803
-2.895865421014	-0.0169559834168	-0.052579921472463	0.052579921472463	0.016955983416801
-2.895865421014	-0.052579921472463	0.016955983416801	-0.0169559834168	0.052579921472463
-5.495865421014	0.013007865239956	-0.013007865239956	-0.013007865239956	0.013007865239956
-0.065016310377872	-0.49657141919901	0.49657141919901	-0.49657141919901	0.49657141919901
-0.065016310377872	0.49657141919901	0.49657141919901	-0.49657141919901	-0.49657141919901
1.4990508897873	-0.16880082730149	0.16880082730149	0.16880082730149	-0.16880082730149
1.6020127310397	0.053982224008452	0.053982224008453	0.053982224008453	0.053982224008452
2.6914110312248	-0.47046214886811	0.47046214886811	0.47046214886811	-0.47046214886811
2.7241027870204	0.0052739966636083	0.012668013269887	-0.01266801326988	-0.0052739966636149
2.7241027870204	-0.012668013269885	0.0052739966636129	-0.0052739966636104	0.012668013269883
4.2433587143306	0.010408531248292	-0.043082799636949	0.043082799636949	-0.010408531248292
4.2433587143306	-0.043082799636949	-0.010408531248292	0.010408531248293	0.043082799636949
4.3302386707305	-0.002637235460287	-0.040268732771286	0.040268732771286	0.0026372354602867
4.3302386707305	-0.040268732771286	0.002637235460287	-0.0026372354602868	0.040268732771286
5.5593177575386	-0.008663540497559	-0.0086635404975588	-0.0086635404975585	-0.0086635404975587
5.69713434203	-0.0015628904724538	0.0015628904724539	0.0015628904724538	-0.0015628904724537
6.7262657744638	0.015238787055749	0.015238787055749	0.015238787055749	0.015238787055749
8.0466432433665	-0.00040567013428627	0.00022042510490411	-0.00022042510490433	0.00040567013428642
8.0466432433665	0.0002204251049043	0.00040567013428654	-0.00040567013428646	-0.00022042510490432

"""
read_cluster_model_instance(solution[0], 0)
