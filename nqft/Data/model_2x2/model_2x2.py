from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('2D_4_sites_2_fermions', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N2:S0'])
set_parameters("""

            U = 8.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 8.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	8
t	1
tp	-0.3

GS_energy: -2.75976 GS_sector: R0:N2:S0:1
GF_format: bl
mixing	0
state
R0:N2:S0	-2.75976	1
w	4	20
-1.0597560273373	-0.45964031638637	-0.45964031638637	-0.45964031638637	-0.45964031638637
-2.4597560273373	-0.053683995835128	-0.18506751505391	0.18506751505391	0.053683995835129
-2.4597560273373	-0.18506751505391	0.053683995835129	-0.053683995835129	0.18506751505391
-5.0597560273373	0.039985284983096	-0.039985284983096	-0.039985284983096	0.039985284983096
0.57212640489353	-0.60055626097027	-0.16235986948566	0.16235986948566	0.60055626097027
0.57212640489353	0.16235986948566	-0.60055626097027	0.60055626097027	-0.16235986948566
1.8246018720419	-0.39914348015862	0.39914348015862	0.39914348015862	-0.39914348015862
3.3576897900184	-0.12259234050557	-0.12259234050558	-0.12259234050558	-0.12259234050557
3.7026590945902	0.010649989236899	-0.081266948556543	0.081266948556543	-0.010649989236898
3.7026590945902	-0.081266948556543	-0.010649989236898	0.010649989236898	0.081266948556543
8.8839266569564	-0.29792666180609	0.29792666180609	0.29792666180609	-0.29792666180609
9.775044839181	-0.1948267966233	0.10317488367909	-0.10317488367909	0.1948267966233
9.775044839181	0.10317488367909	0.1948267966233	-0.1948267966233	-0.1031748836791
10.278328887634	0.14796912361109	0.1479691236111	0.14796912361109	0.14796912361109
10.718545769061	0.010371186274909	0.14286313037628	-0.14286313037628	-0.010371186274911
10.718545769061	-0.14286313037628	0.01037118627491	-0.01037118627491	0.14286313037628
11.870739553014	-0.018037832928731	0.018037832928732	0.018037832928731	-0.018037832928731
12.94324940436	-0.042509246751328	-0.042509246751327	-0.042509246751328	-0.042509246751328
13.330404028961	-0.0013062072774446	-0.00027467563658496	0.00027467563658531	0.001306207277445
13.330404028961	0.00027467563658517	-0.001306207277445	0.0013062072774449	-0.00027467563658514

"""
read_cluster_model_instance(solution[0], 0)
