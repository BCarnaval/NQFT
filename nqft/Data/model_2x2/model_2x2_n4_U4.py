from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U4', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 4.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 4.0
                """)
set_parameter("U", 4.0)
set_parameter("mu", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	4
mu	4
t	1
tp	-0.3

GS_energy: -18.1027 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-18.1027	1
w	4	28
-3.5718706004754	-0.35440030772067	0.2994974439894	-0.2994974439894	0.35440030772067
-3.5718706004754	0.2994974439894	0.35440030772067	-0.35440030772067	-0.2994974439894
-4.3386468683243	-0.47603353101111	-0.47603353101112	-0.47603353101111	-0.47603353101111
-5.8027484834621	0.15105668586668	-0.15105668586668	-0.15105668586668	0.15105668586668
-6.4901060404644	-0.095160341631763	-0.15630087064824	0.15630087064824	0.095160341631763
-6.4901060404644	-0.15630087064824	0.095160341631764	-0.095160341631764	0.15630087064824
-9.5248985091847	0.013666602040317	0.031598676509056	-0.031598676509055	-0.013666602040317
-9.5248985091847	-0.031598676509056	0.013666602040317	-0.013666602040317	0.031598676509055
-9.8027484834621	0.023565142913377	-0.023565142913377	-0.023565142913377	0.023565142913377
-10.10210990617	-0.0029339249554247	-0.0046142418578269	0.0046142418578269	0.0029339249554249
-10.10210990617	-0.0046142418578269	0.0029339249554248	-0.0029339249554249	0.0046142418578272
-11.2668500986	0.0043172963225912	0.0043172963225913	0.0043172963225912	0.0043172963225908
-13.124757361016	-0.00091850672041058	-0.0005049552674227	0.00050495526742271	0.00091850672041043
-13.124757361016	-0.0005049552674229	0.00091850672041085	-0.00091850672041078	0.00050495526742285
-0.90240790669452	-0.35184088085288	-0.32921577986376	0.32921577986376	0.35184088085288
-0.90240790669452	0.32921577986376	-0.35184088085288	0.35184088085288	-0.32921577986376
0.93864686832433	0.47603353101111	-0.47603353101111	-0.47603353101111	0.47603353101111
2.4027484834621	0.15105668586668	0.15105668586668	0.15105668586668	0.15105668586668
3.1623598542086	-0.12867195390677	0.027773828748141	-0.027773828748142	0.12867195390677
3.1623598542086	0.027773828748142	0.12867195390677	-0.12867195390678	-0.027773828748141
5.0377861635413	-0.018709690373989	0.0066883917949591	-0.006688391794958	0.018709690373988
5.0377861635413	0.0066883917949582	0.018709690373989	-0.018709690373988	-0.006688391794959
6.3081480542805	-0.0070371886127102	-0.0061996266521859	0.0061996266521837	0.0070371886127089
6.3081480542805	0.0061996266521851	-0.00703718861271	0.0070371886127096	-0.0061996266521849
6.4027484834621	-0.023565142913377	-0.023565142913377	-0.023565142913377	-0.023565142913377
7.8668500985998	-0.0043172963225915	0.0043172963225911	0.0043172963225913	-0.004317296322591
8.6078562519745	0.00095002890928213	-0.0036688575916318	0.0036688575916315	-0.00095002890928175
8.6078562519745	-0.0036688575916321	-0.00095002890928189	0.00095002890928212	0.0036688575916318

"""
read_cluster_model_instance(solution[0], 0)
