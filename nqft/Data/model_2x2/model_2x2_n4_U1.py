from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U1', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

            U = 1.0
            t = -1.0
            tp = 0.3
            tpp = -0.2
            """)
set_parameter("U", 1.0)
set_parameter("t", -1.0)
set_parameter("tp", 0.3)
set_parameter("tpp", -0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1
t	-1
tp	0.3

GS_energy: -3.34085 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-3.34085	1
w	4	28
0.50949790564671	0.22263125735429	0.44555405284818	-0.44555405284818	-0.22263125735429
0.50949790564671	-0.44555405284818	0.22263125735429	-0.22263125735429	0.44555405284818
-1.8495597697704	-0.49745588660669	0.49745588660669	0.49745588660669	-0.49745588660669
-2.3380719795163	0.048226452542243	0.048226452542243	0.048226452542243	0.048226452542244
-3.6601350890326	0.018864456794713	-0.030064776423634	0.030064776423634	-0.018864456794713
-3.6601350890326	-0.030064776423634	-0.018864456794713	0.018864456794713	0.030064776423634
-3.8009049438766	-0.020204600295976	-0.0030093463033471	0.0030093463033471	0.020204600295976
-3.8009049438766	0.0030093463033471	-0.020204600295976	0.020204600295976	-0.0030093463033472
-4.8517539594405	0.0065471541470235	-0.01402781559211	0.014027815592111	-0.0065471541470234
-4.8517539594405	-0.014027815592111	-0.0065471541470234	0.0065471541470236	0.014027815592111
-5.9436232549803	0.014512915200835	0.014512915200835	0.014512915200835	0.014512915200835
-6.4321354647263	-0.0011069995113162	0.001106999511316	0.0011069995113161	-0.001106999511316
-7.6009419995388	0.00033053861429526	-0.00033852040566267	0.00033852040566267	-0.00033053861429519
-7.6009419995388	-0.00033852040566324	-0.00033053861429545	0.00033053861429579	0.00033852040566293
1.0799658858564	-0.4476528809286	0.21490700461214	-0.21490700461214	0.4476528809286
1.0799658858564	0.21490700461214	0.4476528809286	-0.4476528809286	-0.21490700461214
2.2495597697704	0.49745588660669	0.49745588660669	0.49745588660669	0.49745588660669
2.7380719795163	0.048226452542242	-0.048226452542245	-0.048226452542245	0.048226452542242
3.8690849832547	-0.047439638283768	-0.015297058919443	0.015297058919443	0.047439638283768
3.8690849832547	-0.015297058919443	0.047439638283768	-0.047439638283768	0.015297058919443
5.3883409105649	0.0064770985702994	-0.0291583463729	0.0291583463729	-0.0064770985702994
5.3883409105649	-0.029158346372901	-0.0064770985702995	0.0064770985702994	0.029158346372901
5.4752208669649	-0.0056932476959862	-0.0035749695887996	0.0035749695887994	0.0056932476959861
5.4752208669649	0.0035749695887998	-0.0056932476959863	0.0056932476959864	-0.0035749695887996
6.3436232549803	0.014512915200835	-0.014512915200834	-0.014512915200835	0.014512915200835
6.8321354647263	-0.0011069995113162	-0.0011069995113164	-0.0011069995113162	-0.0011069995113163
9.1916254396008	-3.9901685832946e-05	3.5139133409586e-05	-3.5139133409749e-05	3.9901685832814e-05
9.1916254396008	3.5139133410052e-05	3.9901685833313e-05	-3.990168583325e-05	-3.513913340999e-05

"""
read_cluster_model_instance(solution[0], 0)
