from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U1', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

            U = 1.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 1.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1
t	1
tp	-0.3

GS_energy: -3.34085 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-3.34085	1
w	4	28
-0.079965885856443	0.15554260797947	0.4715767376981	-0.4715767376981	-0.15554260797947
-0.079965885856443	-0.4715767376981	0.15554260797947	-0.15554260797947	0.4715767376981
-1.2495597697704	-0.49745588660669	-0.49745588660669	-0.49745588660669	-0.49745588660669
-1.7380719795164	-0.048226452542244	0.048226452542243	0.048226452542243	-0.048226452542244
-2.8690849832547	0.020181023794829	-0.045576809571011	0.045576809571011	-0.020181023794829
-2.8690849832547	-0.045576809571012	-0.020181023794829	0.020181023794829	0.045576809571012
-4.3883409105649	0.020632793580208	-0.021597448881012	0.021597448881012	-0.020632793580208
-4.3883409105649	-0.021597448881012	-0.020632793580208	0.020632793580208	0.021597448881012
-4.4752208669649	0.0021175449647284	-0.0063803981232401	0.0063803981232402	-0.0021175449647283
-4.4752208669649	-0.0063803981232404	-0.0021175449647285	0.0021175449647284	0.0063803981232404
-5.3436232549803	0.014512915200835	-0.014512915200835	-0.014512915200835	0.014512915200835
-5.8321354647263	-0.0011069995113162	-0.0011069995113161	-0.0011069995113161	-0.001106999511316
-8.1916254396008	3.0045328366165e-05	-4.3865492958009e-05	4.3865492958027e-05	-3.0045328366155e-05
-8.1916254396008	-4.3865492958555e-05	-3.0045328366539e-05	3.0045328366546e-05	4.3865492958597e-05
0.4905020943533	-0.48012841307386	0.1325133869455	-0.1325133869455	0.48012841307386
0.4905020943533	0.13251338694551	0.48012841307386	-0.48012841307386	-0.13251338694551
2.8495597697704	0.49745588660669	-0.49745588660669	-0.49745588660669	0.49745588660669
3.3380719795164	-0.048226452542241	-0.048226452542246	-0.048226452542245	-0.048226452542241
4.6601350890326	-0.032011704488419	-0.015330012632376	0.015330012632376	0.032011704488419
4.6601350890326	-0.015330012632376	0.03201170448842	-0.03201170448842	0.015330012632376
4.8009049438766	0.012764162520435	0.015948611019319	-0.015948611019319	-0.012764162520434
4.8009049438766	-0.015948611019319	0.012764162520435	-0.012764162520435	0.015948611019319
5.8517539594405	-0.013159948950021	-0.0081523359440092	0.0081523359440093	0.013159948950021
5.8517539594405	0.0081523359440096	-0.013159948950021	0.013159948950021	-0.0081523359440092
6.9436232549803	0.014512915200835	0.014512915200835	0.014512915200835	0.014512915200835
7.4321354647263	0.0011069995113159	-0.001106999511316	-0.0011069995113158	0.001106999511316
8.6009419995388	0.0002987824057868	-0.00036685271510842	0.00036685271510831	-0.00029878240578674
8.6009419995388	-0.00036685271510903	-0.00029878240578718	0.00029878240578732	0.00036685271510889

"""
read_cluster_model_instance(solution[0], 0)
