from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U1', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 1.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 0.000000001
                """)
set_parameter("U", 1.0)
set_parameter("mu", 1e-09)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1
mu	1e-09
t	1
tp	-0.3

GS_energy: -3.34085 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-3.34085	1
w	4	28
-0.079965886856448	-0.38994900417601	-0.30743763038571	0.30743763038571	0.38994900417601
-0.079965886856448	0.30743763038571	-0.38994900417601	0.38994900417601	-0.30743763038571
-1.2495597707704	0.49745588660669	0.49745588660669	0.49745588660669	0.49745588660669
-1.7380719805164	-0.048226452542242	0.048226452542244	0.048226452542244	-0.048226452542243
-2.8690849842547	-0.035756893777945	0.034726990071592	-0.034726990071592	0.035756893777945
-2.8690849842547	0.034726990071593	0.035756893777945	-0.035756893777945	-0.034726990071593
-4.3883409115649	-0.028891313180495	0.0075798411459584	-0.0075798411459584	0.028891313180495
-4.3883409115649	0.0075798411459585	0.028891313180495	-0.028891313180495	-0.0075798411459584
-4.4752208679649	0.0025257865018837	-0.0062300786058921	0.006230078605892	-0.0025257865018837
-4.4752208679649	-0.0062300786058925	-0.0025257865018839	0.0025257865018838	0.0062300786058925
-5.3436232559803	-0.014512915200834	0.014512915200835	0.014512915200835	-0.014512915200835
-5.8321354657263	0.0011069995113159	0.0011069995113159	0.001106999511316	0.001106999511316
-8.1916254406008	-4.1205347967407e-05	-3.3600930462559e-05	3.3600930462658e-05	4.1205347967571e-05
-8.1916254406008	-3.3600930462978e-05	4.1205347967781e-05	-4.1205347967941e-05	3.3600930462847e-05
0.4905020933533	0.30027358079174	-0.39739006962819	0.39739006962819	-0.30027358079174
0.4905020933533	-0.39739006962819	-0.30027358079174	0.30027358079174	0.39739006962819
2.8495597687704	-0.49745588660669	0.49745588660669	0.49745588660669	-0.49745588660669
3.3380719785164	0.048226452542243	0.048226452542243	0.048226452542243	0.048226452542243
4.6601350880326	0.023192097709114	0.026867919819249	-0.026867919819249	-0.023192097709114
4.6601350880326	-0.026867919819249	0.023192097709115	-0.023192097709115	0.026867919819249
4.8009049428766	-0.019862673976671	0.0047703480785027	-0.0047703480785026	0.019862673976671
4.8009049428766	0.0047703480785026	0.019862673976672	-0.019862673976671	-0.0047703480785029
5.8517539584405	0.00068711217226003	-0.015465209813445	0.015465209813445	-0.0006871121722599
5.8517539584405	-0.015465209813445	-0.00068711217225993	0.00068711217226002	0.015465209813445
6.9436232539803	0.014512915200835	0.014512915200834	0.014512915200835	0.014512915200835
7.4321354637263	-0.0011069995113158	0.001106999511316	0.0011069995113159	-0.0011069995113158
8.6009419985388	-0.00036077447296238	-0.00030609413625396	0.00030609413625405	0.00036077447296227
8.6009419985388	0.00030609413625426	-0.00036077447296262	0.0003607744729627	-0.00030609413625432

"""
read_cluster_model_instance(solution[0], 0)
