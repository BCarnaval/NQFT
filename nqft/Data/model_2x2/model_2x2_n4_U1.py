from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U1', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 1.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 4.0
                """)
set_parameter("U", 1.0)
set_parameter("mu", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	1
mu	4
t	1
tp	-0.3

GS_energy: -19.3408 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-19.3408	1
w	4	28
-4.0799658858564	-0.44308509528158	0.22417341674325	-0.22417341674325	0.44308509528158
-4.0799658858564	0.22417341674326	0.44308509528159	-0.44308509528159	-0.22417341674326
-5.2495597697704	0.49745588660669	0.49745588660669	0.49745588660669	0.49745588660669
-5.7380719795164	0.048226452542243	-0.048226452542243	-0.048226452542244	0.048226452542242
-6.8690849832547	-0.049360258068373	-0.0069342782972082	0.0069342782972085	0.049360258068374
-6.8690849832547	0.0069342782972087	-0.049360258068375	0.049360258068376	-0.0069342782972084
-8.3883409105649	0.015991868502141	0.025227407930694	-0.025227407930693	-0.01599186850214
-8.3883409105649	-0.025227407930694	0.015991868502141	-0.015991868502141	0.025227407930694
-8.4752208669648	-0.0064498535714489	-0.0018954856358067	0.0018954856358072	0.0064498535714496
-8.4752208669648	-0.0018954856358074	0.0064498535714499	-0.0064498535714503	0.001895485635807
-9.3436232549803	0.014512915200835	-0.014512915200835	-0.014512915200835	0.014512915200835
-9.8321354647263	0.0011069995113163	0.0011069995113163	0.0011069995113166	0.0011069995113166
-12.191625439601	-4.5511934789514e-05	2.7487579391672e-05	-2.7487579392081e-05	4.5511934789128e-05
-12.191625439601	2.7487579392159e-05	4.5511934789733e-05	-4.5511934789453e-05	-2.7487579391923e-05
-3.5094979056467	0.22098927387657	0.44637073335076	-0.44637073335075	-0.22098927387657
-3.5094979056467	-0.44637073335077	0.22098927387658	-0.22098927387658	0.44637073335077
-1.1504402302296	-0.49745588660669	0.49745588660669	0.49745588660669	-0.49745588660669
-0.66192802048366	-0.048226452542245	-0.04822645254224	-0.048226452542242	-0.048226452542246
0.66013508903255	0.02447048324471	-0.02570902490047	0.02570902490047	-0.02447048324471
0.66013508903255	-0.025709024900471	-0.024470483244711	0.024470483244711	0.025709024900471
0.80090494387656	0.01004392010192	-0.017787684146055	0.017787684146055	-0.010043920101919
0.80090494387656	-0.017787684146057	-0.01004392010192	0.01004392010192	0.017787684146056
1.8517539594405	0.0062842734810248	-0.01414753492757	0.014147534927571	-0.0062842734810258
1.8517539594405	-0.014147534927571	-0.0062842734810256	0.0062842734810256	0.014147534927571
2.9436232549803	0.014512915200835	0.014512915200834	0.014512915200834	0.014512915200835
3.4321354647263	-0.0011069995113161	0.0011069995113164	0.0011069995113161	-0.0011069995113161
4.6009419995388	-0.00046456608492354	8.9611345984322e-05	-8.9611345984291e-05	0.00046456608492335
4.6009419995388	8.961134598448e-05	0.00046456608492386	-0.00046456608492406	-8.9611345984331e-05

"""
read_cluster_model_instance(solution[0], 0)
