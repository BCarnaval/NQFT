from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U001', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 0.01
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 3.9
                """)
set_parameter("U", 0.01)
set_parameter("mu", 3.9)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	0.01
mu	3.9
t	1
tp	-0.3

GS_energy: -19.5925 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-19.5925	1
w	4	22
-4.1975040057382	-0.49999930065055	0.00055254831982017	-0.00055254831982043	0.49999930065055
-4.1975040057382	0.00055254831991753	0.49999930073807	-0.49999930073807	-0.00055254831991659
-5.5950054628979	-0.4999996833486	-0.49999968334865	-0.49999968334865	-0.4999996833486
-5.5999981306572	0.00054058998601316	-0.00054059003677579	-0.00054059003677432	0.00054058998601451
-6.9975007819575	-0.00044721029514341	-2.3380590162614e-06	2.3380590177659e-06	0.00044721029514499
-6.9975007819575	2.3380590175775e-06	-0.00044721029522205	0.00044721029522222	-2.3380590172646e-06
-8.2000094872506	-0.00038897423476926	0.00016590891023253	-0.00016590891023118	0.00038897423477049
-8.2000094872506	0.00016590891025416	0.0003889742348216	-0.00038897423482137	-0.00016590891025358
-8.2000211948219	4.8296151060614e-05	0.0001132863630438	-0.00011328636304406	-4.8296151061223e-05
-8.2000211948219	-0.00011328636322352	4.8296151137568e-05	-4.8296151137346e-05	0.00011328636322342
-9.5950148379015	-0.00015624878761619	0.00015624878761676	0.00015624878761695	-0.00015624878761605
-4.1924949634021	0.00055242824718817	0.49999944246535	-0.49999944246535	-0.00055242824719076
-4.1924949634021	-0.49999944255287	0.00055242824728622	-0.00055242824728607	0.49999944255287
-1.5949945371021	0.49999968334865	-0.4999996833486	-0.4999996833486	0.49999968334865
-1.589995891815	0.00054059003651476	0.00054058998627281	0.00054058998627475	0.0005405900365158
-0.19000096078342	-0.00026402940871889	-0.0001547763458336	0.00015477634583291	0.00026402940871959
-0.19000096078342	0.00015477634587738	-0.00026402940879412	0.00026402940879426	-0.000154776345877
-0.18998919043578	0.00016121822743846	-0.00027413276934444	0.00027413276934369	-0.00016121822743768
-0.18998919043578	-0.00027413276941736	-0.00016121822748091	0.00016121822748122	0.000274132769417
1.0075195548175	0	0.00023980458487778	-0.00023980458487847	0
1.0075195548175	-0.00023980458492073	0	0	0.00023980458491991
2.4050148379016	0.00015624878761693	0.00015624878761642	0.00015624878761594	0.00015624878761673

"""
read_cluster_model_instance(solution[0], 0)
