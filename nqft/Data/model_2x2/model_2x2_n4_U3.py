from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U3', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 3.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 4.0
                """)
set_parameter("U", 3.0)
set_parameter("mu", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	3
mu	4
t	1
tp	-0.3

GS_energy: -18.4244 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-18.4244	1
w	4	28
-3.7244289008981	0.10931360517778	-0.46368527681298	0.46368527681299	-0.10931360517778
-3.7244289008981	-0.46368527681299	-0.10931360517778	0.10931360517778	0.46368527681299
-4.5830476357489	0.4841714380645	0.4841714380645	0.4841714380645	0.4841714380645
-5.8216532631661	0.12205510606113	-0.12205510606112	-0.12205510606112	0.12205510606113
-6.578667175231	-0.058988551397193	-0.13401360888571	0.13401360888571	0.058988551397193
-6.578667175231	-0.13401360888571	0.058988551397193	-0.058988551397195	0.13401360888571
-9.0200275537442	-0.038957164659646	-0.0068175202533252	0.0068175202533241	0.038957164659646
-9.0200275537442	0.0068175202533254	-0.038957164659646	0.038957164659647	-0.0068175202533241
-9.42720453863	-0.025801271064556	0.025801271064555	0.025801271064556	-0.025801271064554
-9.4469625049234	0.0010338934151634	-0.0064538571122833	0.0064538571122849	-0.0010338934151649
-9.4469625049234	-0.0064538571122815	-0.0010338934151673	0.0010338934151611	0.0064538571122875
-10.665810166047	0.0038553934192677	0.0038553934192679	0.0038553934192681	0.003855393419268
-12.652058369694	-0.00046319614232053	0.00035806253314683	-0.00035806253314673	0.00046319614232083
-12.652058369694	0.00035806253314677	0.00046319614232072	-0.00046319614232108	-0.00035806253314713
-1.7944622244929	-0.47636223495784	-0.10657333054158	0.10657333054158	0.47636223495784
-1.7944622244929	0.10657333054158	-0.47636223495784	0.47636223495784	-0.10657333054158
0.18304763574895	-0.4841714380645	0.4841714380645	0.4841714380645	-0.4841714380645
1.421653263166	-0.12205510606112	-0.12205510606113	-0.12205510606113	-0.12205510606112
2.3347530999761	-0.084200963534153	0.062553275756386	-0.062553275756387	0.084200963534155
2.3347530999761	0.062553275756389	0.084200963534155	-0.084200963534157	-0.062553275756387
3.5001945146792	0.012999247539821	0.019699158126679	-0.01969915812668	-0.01299924753982
3.5001945146792	-0.01969915812668	0.01299924753982	-0.012999247539821	0.019699158126681
4.6714491309819	-0.011664195245728	0.0041018413518053	-0.0041018413518053	0.011664195245728
4.6714491309819	0.0041018413518056	0.011664195245729	-0.011664195245729	-0.0041018413518056
5.0272045386301	0.025801271064555	0.025801271064554	0.025801271064554	0.025801271064556
6.2658101660472	0.003855393419268	-0.0038553934192679	-0.0038553934192679	0.0038553934192682
7.1102099833459	-0.0029010223734745	-0.00031623376687416	0.00031623376687388	0.002901022373475
7.1102099833459	0.00031623376687398	-0.0029010223734748	0.0029010223734747	-0.00031623376687405

"""
read_cluster_model_instance(solution[0], 0)
