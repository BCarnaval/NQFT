from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n2_U001', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N2:S0'])
set_parameters("""

                U = 0.01
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 3.9
                """)
set_parameter("U", 0.01)
set_parameter("mu", 3.9)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	0.01
mu	3.9
t	1
tp	-0.3

GS_energy: -11.1975 GS_sector: R0:N2:S0:1
GF_format: bl
mixing	0
state
R0:N2:S0	-11.1975	1
w	4	14
-5.5975052387597	0.49999957803709	0.49999957803709	0.49999957803709	0.49999957803708
-6.9975052387597	-0.0005748403377191	0.00025921871581279	-0.00025921871581112	0.00057484033771951
-6.9975052387597	0.00025921871581209	0.00057484033771954	-0.00057484033772002	-0.00025921871581223
-9.5975052387597	-0.00015597108475965	0.00015597108475891	0.00015597108475929	-0.00015597108475907
-4.1975009000425	-0.65088242504815	-0.27631735472291	0.27631735472291	0.65088242504815
-4.1975009000425	-0.27631735472291	0.65088242504815	-0.65088242504815	0.27631735472291
-2.7950067751234	0.00063047723027376	0.00063047723027263	0.00063047723027445	0.00063047723027307
-2.7950067751234	-0.0014775140163647	0.001477514016365	0.0014775140163653	-0.0014775140163662
-1.5974887645799	0.49999779262044	-0.49999779262044	-0.49999779262044	0.49999779262044
-0.19499541853002	4.1256581148639e-05	0.00044969086900117	-0.00044969086900178	-4.1256581147917e-05
-0.19499541853002	-0.00044969086908917	4.1256581156337e-05	-4.1256581156192e-05	0.00044969086908789
-0.19498371095875	-0.00043032889645731	3.86801131665e-05	-3.8680113167548e-05	0.00043032889645745
-0.19498371095875	3.8680113174653e-05	0.00043032889654866	-0.00043032889654791	-3.8680113175738e-05
2.4025180720289	0.00015639841821805	0.00015639841821877	0.00015639841821931	0.00015639841821781

"""
read_cluster_model_instance(solution[0], 0)
