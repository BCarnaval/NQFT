from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U2', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 2.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 4.0
                """)
set_parameter("U", 2.0)
set_parameter("mu", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	2
mu	4
t	1
tp	-0.3

GS_energy: -18.8284 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-18.8284	1
w	4	28
-3.8934489693903	-0.48449373006594	-0.057752261971601	0.057752261971601	0.48449373006594
-3.8934489693903	0.057752261971602	-0.48449373006595	0.48449373006595	-0.057752261971602
-4.8826758136816	-0.49162825282993	-0.49162825282993	-0.49162825282993	-0.49162825282993
-5.7963763171773	-0.087968416142529	0.087968416142532	0.087968416142532	-0.087968416142528
-6.6980034913654	-0.094524213287018	0.036407702729284	-0.036407702729284	0.094524213287017
-6.6980034913654	0.036407702729285	0.094524213287019	-0.094524213287019	-0.036407702729285
-8.6348026490033	0.0049539444832376	-0.039886412869832	0.039886412869832	-0.0049539444832368
-8.6348026490033	-0.039886412869833	-0.0049539444832371	0.0049539444832375	0.039886412869833
-8.8894436268962	-0.0072464672990524	0.0014680276361931	-0.0014680276361933	0.0072464672990531
-8.8894436268962	0.0014680276361935	0.0072464672990533	-0.0072464672990525	-0.001468027636193
-9.2604779323151	-0.023571066064836	0.023571066064835	0.023571066064836	-0.023571066064836
-10.174178435811	0.0027610913295534	0.0027610913295537	0.0027610913295535	0.0027610913295535
-12.326436887076	-0.00013177435475217	-5.2847823161499e-05	5.2847823161364e-05	0.00013177435475204
-12.326436887076	5.2847823161673e-05	-0.00013177435475262	0.00013177435475264	-5.2847823161608e-05
-2.6665060316932	0.055801857682926	-0.49060126397009	0.49060126397009	-0.055801857682927
-2.6665060316932	-0.4906012639701	-0.055801857682929	0.055801857682927	0.4906012639701
-0.51732418631841	0.49162825282993	-0.49162825282993	-0.49162825282993	0.49162825282993
0.39637631717731	-0.087968416142534	-0.087968416142527	-0.087968416142527	-0.087968416142532
1.5158375022646	0.024246690106249	0.068661783153517	-0.068661783153515	-0.02424669010625
1.5158375022646	-0.068661783153517	0.02424669010625	-0.02424669010625	0.068661783153518
2.0784351825985	-0.021047317623691	-0.014141670062201	0.014141670062201	0.021047317623691
2.0784351825985	-0.014141670062201	0.021047317623691	-0.021047317623691	0.014141670062201
3.1562945789201	-0.005846713129668	-0.01463766674255	0.014637666742551	0.0058467131296676
3.1562945789201	-0.014637666742552	0.005846713129668	-0.0058467131296682	0.014637666742551
3.8604779323151	0.023571066064836	0.023571066064836	0.023571066064836	0.023571066064836
4.7741784358108	-0.0027610913295539	0.0027610913295535	0.0027610913295539	-0.0027610913295538
5.7580743916409	-0.001295142535247	0.0010539808228766	-0.001053980822877	0.0012951425352473
5.7580743916409	0.0010539808228772	0.0012951425352476	-0.0012951425352475	-0.0010539808228771

"""
read_cluster_model_instance(solution[0], 0)
