from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('2D_4_sites_2_fermions', [[2, 0, 0], [1, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N2:S0'])
set_parameters("""

            U = 4.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	4
t	1
tp	-0.3

GS_energy: -2.90066 GS_sector: R0:N2:S0:1
GF_format: bl
mixing	0
state
R0:N2:S0	-2.90066	1
w	4	20
-1.2006586095025	0.47702472890691	0.47702472890691	0.47702472890691	0.47702472890691
-2.6006586095025	0.0087012270421222	-0.14616152540007	0.14616152540007	-0.008701227042122
-2.6006586095025	-0.14616152540007	-0.0087012270421221	0.0087012270421222	0.14616152540007
-5.2006586095025	-0.031756970132235	0.031756970132236	0.031756970132236	-0.031756970132235
0.36978072651579	-0.58340460123099	-0.31390263116101	0.31390263116101	0.58340460123099
0.36978072651579	0.31390263116101	-0.58340460123099	0.58340460123099	-0.31390263116101
1.7852651239333	0.36351125608737	-0.36351125608737	-0.36351125608737	0.36351125608737
2.7639352394568	-0.12119247606585	-0.12119247606585	-0.12119247606585	-0.12119247606585
3.2880161665049	0.0049002361063151	-0.068164627271918	0.068164627271918	-0.004900236106315
3.2880161665049	-0.068164627271919	-0.004900236106315	0.0049002361063152	0.068164627271919
5.0832541917999	0.34166430929528	-0.34166430929528	-0.34166430929528	0.34166430929528
6.3228086352252	0.088500693643813	0.12387200190622	-0.12387200190622	-0.088500693643813
6.3228086352252	-0.12387200190622	0.088500693643813	-0.088500693643813	0.12387200190622
6.9000200322105	0.0085362076351915	-0.10835148480153	0.10835148480153	-0.0085362076351917
6.9000200322105	-0.10835148480153	-0.0085362076351917	0.0085362076351916	0.10835148480153
7.0922025481228	0.080634080589397	0.080634080589397	0.080634080589396	0.080634080589397
8.1334565127743	-0.010796355847215	0.010796355847215	0.010796355847215	-0.010796355847215
9.1458380409279	-0.035467404808123	-0.035467404808123	-0.035467404808123	-0.035467404808123
9.9226674870563	0.00040398266074878	0.0022710999985703	-0.0022710999985702	-0.0004039826607488
9.9226674870563	-0.0022710999985705	0.00040398266074886	-0.0004039826607488	0.0022710999985705

"""
read_cluster_model_instance(solution[0], 0)
