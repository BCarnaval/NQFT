from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U8', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 8.0
                t = -1.0
                tp = 0.3
                tpp = -0.2
                """)
set_parameter("U", 8.0)
set_parameter("t", -1.0)
set_parameter("tp", 0.3)
set_parameter("tpp", -0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	8
t	-1
tp	0.3

GS_energy: -1.32023 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-1.32023	1
w	4	28
1.1951381244863	0.12544286673658	0.44028278711527	-0.44028278711527	-0.12544286673658
1.1951381244863	-0.44028278711528	0.12544286673658	-0.12544286673658	0.44028278711527
-0.32873233614275	0.44580616617024	-0.44580616617024	-0.44580616617024	0.44580616617024
-2.1561333431342	-0.22612882825217	-0.22612882825217	-0.22612882825217	-0.22612882825217
-2.6772940735343	0.075091526372527	-0.18621820561903	0.18621820561903	-0.075091526372528
-2.6772940735343	-0.18621820561903	-0.075091526372527	0.075091526372528	0.18621820561903
-7.91736685191	0.0026102689920254	-0.0079810396946326	0.0079810396946329	-0.0026102689920254
-7.91736685191	-0.0079810396946327	-0.0026102689920253	0.0026102689920255	0.007981039694633
-9.0843365734097	-0.010508933332093	-0.010508933332093	-0.010508933332093	-0.010508933332093
-9.4649877166609	0.0021132954364178	0.002898971835077	-0.0028989718350768	-0.0021132954364177
-9.4649877166609	-0.0028989718350772	0.0021132954364179	-0.002113295436418	0.0028989718350772
-10.911737580401	0.0034896358144456	-0.0034896358144457	-0.0034896358144456	0.0034896358144454
-11.436664273741	-0.0032611690334037	-0.002276255785727	0.0022762557857272	0.0032611690334036
-11.436664273741	0.0022762557857272	-0.0032611690334037	0.0032611690334038	-0.0022762557857273
7.1326053358281	-0.37564795974334	0.19346962875325	-0.19346962875325	0.37564795974334
7.1326053358281	0.19346962875325	0.37564795974335	-0.37564795974334	-0.19346962875325
7.7287323361427	0.44580616617024	0.44580616617024	0.44580616617024	0.44580616617024
9.5561333431342	-0.22612882825217	0.22612882825217	0.22612882825217	-0.22612882825217
10.263138025525	-0.25241816879446	-0.086631360442384	0.086631360442384	0.25241816879446
10.263138025525	0.086631360442384	-0.25241816879446	0.25241816879446	-0.086631360442385
16.335523770116	0.0067902551684472	0.013512091733772	-0.013512091733772	-0.0067902551684478
16.335523770116	-0.013512091733772	0.0067902551684479	-0.0067902551684473	0.013512091733772
16.48433657341	0.010508933332093	-0.010508933332093	-0.010508933332093	0.010508933332093
17.279024699996	-0.0018409193524449	0.0018365454033246	-0.0018365454033248	0.0018409193524444
17.279024699996	0.0018365454033248	0.001840919352445	-0.0018409193524446	-0.0018365454033249
18.311737580401	0.0034896358144456	0.0034896358144452	0.0034896358144456	0.0034896358144455
19.890882959895	-0.0015385303388295	-0.00061269416114577	0.00061269416114579	0.0015385303388294
19.890882959895	0.00061269416114562	-0.0015385303388297	0.0015385303388293	-0.00061269416114598

"""
read_cluster_model_instance(solution[0], 0)
