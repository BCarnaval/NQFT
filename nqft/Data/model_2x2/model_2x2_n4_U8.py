from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U8', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

            U = 8.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 8.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	8
t	1
tp	-0.3

GS_energy: -1.32023 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-1.32023	1
w	4	28
0.86739466417185	-0.32373889869086	-0.2715419164396	0.2715419164396	0.32373889869086
0.86739466417185	0.2715419164396	-0.32373889869086	0.32373889869086	-0.2715419164396
0.27126766385724	-0.44580616617024	-0.44580616617024	-0.44580616617024	-0.44580616617024
-1.5561333431342	-0.22612882825217	0.22612882825217	0.22612882825217	-0.22612882825217
-2.2631380255248	-0.20502440399379	0.17083593976866	-0.17083593976866	0.20502440399379
-2.2631380255248	0.17083593976866	0.20502440399379	-0.20502440399379	-0.17083593976866
-8.3355237701156	0.0032379781451863	-0.014771583727068	0.014771583727068	-0.0032379781451862
-8.3355237701156	-0.014771583727068	-0.0032379781451863	0.0032379781451863	0.014771583727068
-8.4843365734097	0.010508933332093	-0.010508933332093	-0.010508933332093	0.010508933332093
-9.279024699996	-0.0022862531354733	-0.0012389227906594	0.0012389227906594	0.0022862531354736
-9.279024699996	-0.0012389227906596	0.0022862531354737	-0.0022862531354736	0.0012389227906596
-10.311737580401	0.0034896358144456	0.0034896358144456	0.0034896358144456	0.0034896358144456
-11.890882959895	-0.0016541771130318	7.8535452641266e-05	-7.8535452641383e-05	0.0016541771130318
-11.890882959895	7.8535452641364e-05	0.0016541771130319	-0.001654177113032	-7.8535452641299e-05
6.8048618755137	0.26914113396771	-0.3703348423409	0.3703348423409	-0.26914113396771
6.8048618755137	-0.3703348423409	-0.26914113396772	0.26914113396771	0.3703348423409
8.3287323361428	-0.44580616617024	0.44580616617024	0.44580616617024	-0.44580616617024
10.156133343134	-0.22612882825217	-0.22612882825216	-0.22612882825217	-0.22612882825217
10.677294073534	-0.14050949974582	-0.14343304332722	0.14343304332722	0.14050949974582
10.677294073534	-0.14343304332722	0.14050949974582	-0.14050949974582	0.14343304332722
15.91736685191	0.0023591502123681	0.0080588404310741	-0.0080588404310743	-0.002359150212368
15.91736685191	-0.0080588404310744	0.0023591502123681	-0.0023591502123682	0.0080588404310745
17.08433657341	-0.010508933332093	-0.010508933332093	-0.010508933332093	-0.010508933332093
17.464987716661	-0.0022343560893927	-0.0028067255241557	0.0028067255241557	0.0022343560893926
17.464987716661	-0.0028067255241559	0.0022343560893929	-0.0022343560893928	0.002806725524156
18.911737580401	0.0034896358144457	-0.0034896358144454	-0.0034896358144455	0.0034896358144454
19.436664273741	0.0019234297302821	-0.0034809455524544	0.0034809455524544	-0.0019234297302821
19.436664273741	-0.0034809455524544	-0.0019234297302821	0.0019234297302821	0.0034809455524545

"""
read_cluster_model_instance(solution[0], 0)
