from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U8', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 8.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 4.0
                """)
set_parameter("U", 8.0)
set_parameter("mu", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	8
mu	4
t	1
tp	-0.3

GS_energy: -17.3202 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-17.3202	1
w	4	28
-3.1326053358281	0.27564305232225	0.32025426556992	-0.32025426556992	-0.27564305232225
-3.1326053358281	-0.32025426556992	0.27564305232226	-0.27564305232225	0.32025426556992
-3.7287323361427	-0.44580616617024	-0.44580616617024	-0.44580616617024	-0.44580616617024
-5.5561333431342	-0.22612882825217	0.22612882825217	0.22612882825216	-0.22612882825217
-6.2631380255248	0.16339128418984	-0.21100524353779	0.21100524353779	-0.16339128418984
-6.2631380255248	-0.21100524353779	-0.16339128418985	0.16339128418984	0.21100524353779
-12.335523770116	-0.013671355267174	0.0064636083910772	-0.0064636083910775	0.013671355267174
-12.335523770116	0.0064636083910776	0.013671355267174	-0.013671355267174	-0.0064636083910774
-12.48433657341	0.010508933332093	-0.010508933332093	-0.010508933332093	0.010508933332093
-13.279024699996	-0.0020659522083518	-0.0015791531127423	0.0015791531127423	0.0020659522083517
-13.279024699996	0.0015791531127426	-0.0020659522083521	0.0020659522083521	-0.0015791531127425
-14.311737580401	0.0034896358144456	0.0034896358144454	0.0034896358144454	0.0034896358144456
-15.890882959895	3.1623716004113e-05	-0.0016557384090447	0.0016557384090448	-3.1623716004147e-05
-15.890882959895	-0.001655738409045	-3.1623716004067e-05	3.1623716004205e-05	0.0016557384090451
2.8048618755137	-0.36954613242656	0.27022305870087	-0.27022305870087	0.36954613242656
2.8048618755137	0.27022305870087	0.36954613242656	-0.36954613242656	-0.27022305870087
4.3287323361427	0.44580616617024	-0.44580616617024	-0.44580616617024	0.44580616617024
6.1561333431342	0.22612882825217	0.22612882825217	0.22612882825217	0.22612882825217
6.6772940735343	0.13170170663816	0.15156060802703	-0.15156060802703	-0.13170170663817
6.6772940735343	-0.15156060802703	0.13170170663817	-0.13170170663817	0.15156060802703
11.91736685191	0.0048153911955283	0.0068791355890155	-0.0068791355890154	-0.0048153911955282
11.91736685191	-0.0068791355890156	0.0048153911955284	-0.0048153911955282	0.0068791355890156
13.08433657341	0.010508933332093	0.010508933332093	0.010508933332093	0.010508933332093
13.464987716661	-0.0032528073540064	-0.0015130431652394	0.0015130431652392	0.0032528073540063
13.464987716661	0.0015130431652394	-0.0032528073540065	0.0032528073540066	-0.0015130431652394
14.911737580401	-0.0034896358144454	0.0034896358144455	0.0034896358144458	-0.0034896358144454
15.436664273741	-0.0039329615131428	0.0005902352095758	-0.00059023520957575	0.0039329615131426
15.436664273741	0.00059023520957589	0.0039329615131431	-0.0039329615131433	-0.00059023520957581

"""
read_cluster_model_instance(solution[0], 0)
