from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U8', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 8.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = 0.000000001
                """)
set_parameter("U", 8.0)
set_parameter("mu", 1e-09)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	8
mu	1e-09
t	1
tp	-0.3

GS_energy: -1.32023 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-1.32023	1
w	4	28
0.86739466317185	-0.40218433787317	0.12957486360702	-0.12957486360702	0.40218433787317
0.86739466317185	0.12957486360702	0.40218433787317	-0.40218433787317	-0.12957486360702
0.27126766285725	-0.44580616617024	-0.44580616617024	-0.44580616617024	-0.44580616617024
-1.5561333441342	0.22612882825217	-0.22612882825217	-0.22612882825217	0.22612882825217
-2.2631380265248	-0.26063652767699	-0.057345662347995	0.057345662347995	0.26063652767699
-2.2631380265248	0.057345662347995	-0.26063652767699	0.26063652767699	-0.057345662347995
-8.3355237711156	-0.011830442936145	0.0094193847043807	-0.0094193847043804	0.011830442936144
-8.3355237711156	0.0094193847043807	0.011830442936145	-0.011830442936145	-0.0094193847043808
-8.4843365744097	-0.010508933332093	0.010508933332093	0.010508933332093	-0.010508933332093
-9.279024700996	-0.0023777795857056	0.0010526382676301	-0.0010526382676303	0.0023777795857054
-9.279024700996	0.0010526382676302	0.0023777795857057	-0.0023777795857058	-0.0010526382676304
-10.311737581401	-0.0034896358144455	-0.0034896358144455	-0.0034896358144455	-0.0034896358144455
-11.890882960895	0.00017419631695031	-0.0016468531755325	0.0016468531755324	-0.00017419631695049
-11.890882960895	-0.0016468531755325	-0.00017419631695039	0.00017419631695042	0.0016468531755325
6.8048618745137	-0.1113098529684	-0.44406639377152	0.44406639377151	0.1113098529684
6.8048618745137	-0.44406639377152	0.1113098529684	-0.1113098529684	0.44406639377152
8.3287323351427	0.44580616617024	-0.44580616617024	-0.44580616617024	0.44580616617024
10.156133342134	0.22612882825217	0.22612882825217	0.22612882825217	0.22612882825217
10.677294072534	0.070886280485295	-0.18785923633372	0.18785923633372	-0.070886280485297
10.677294072534	-0.18785923633372	-0.070886280485296	0.070886280485296	0.18785923633372
15.91736685091	-0.0081371056133145	-0.0020731645028302	0.0020731645028302	0.0081371056133145
15.91736685091	-0.0020731645028303	0.0081371056133146	-0.0081371056133148	0.0020731645028303
17.08433657241	0.010508933332093	0.010508933332093	0.010508933332093	0.010508933332093
17.464987715661	-0.0035767203815568	-0.00027771678795638	0.00027771678795657	0.0035767203815563
17.464987715661	0.0002777167879564	-0.0035767203815568	0.0035767203815567	-0.00027771678795657
18.911737579401	-0.0034896358144455	0.0034896358144455	0.0034896358144455	-0.0034896358144454
19.436664272741	0.00043002549278437	-0.0039536871325436	0.0039536871325437	-0.00043002549278455
19.436664272741	-0.0039536871325437	-0.00043002549278444	0.0004300254927845	0.0039536871325437

"""
read_cluster_model_instance(solution[0], 0)
