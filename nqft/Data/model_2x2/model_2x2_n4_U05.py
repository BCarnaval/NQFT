from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U05', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

                U = 0.5
                t = -1.0
                tp = 0.3
                tpp = -0.2
                """)
set_parameter("U", 0.5)
set_parameter("t", -1.0)
set_parameter("tp", 0.3)
set_parameter("tpp", -0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	0.5
t	-1
tp	0.3

GS_energy: -3.64899 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-3.64899	1
w	4	28
0.41372283621196	0.15218401404288	0.47570383636687	-0.47570383636687	-0.15218401404288
0.41372283621196	-0.47570383636687	0.15218401404288	-0.15218401404288	0.47570383636687
-2.0629857854386	-0.49929167249971	0.49929167249971	0.49929167249971	-0.49929167249971
-2.3115281129503	-0.025474206075376	-0.025474206075372	-0.025474206075371	-0.025474206075375
-3.6931727245884	0.0060553631360799	-0.01553949212309	0.01553949212309	-0.00605536313608
-3.6931727245884	-0.01553949212309	-0.0060553631360801	0.00605536313608	0.01553949212309
-3.7260987595493	0.0048501470635642	-0.011900622562122	0.011900622562122	-0.0048501470635644
-3.7260987595493	-0.011900622562122	-0.0048501470635644	0.0048501470635643	0.011900622562122
-4.8251609851569	0.0016093019222224	0.0099995319482703	-0.0099995319482703	-0.0016093019222223
-4.8251609851569	-0.0099995319482706	0.0016093019222224	-0.0016093019222223	0.0099995319482704
-6.0864453305857	0.0076662338240155	0.0076662338240154	0.0076662338240154	0.0076662338240155
-6.3349876580974	-0.00034562439955729	0.00034562439955738	0.00034562439955722	-0.00034562439955713
-7.6142239757572	6.2534759232853e-05	-9.772983953924e-05	9.7729839539095e-05	-6.253475923271e-05
-7.6142239757572	-9.7729839539395e-05	-6.2534759233004e-05	6.2534759232924e-05	9.772983953951e-05
0.68364645585987	-0.47051590779207	0.16642924645728	-0.16642924645728	0.47051590779206
0.68364645585987	0.16642924645729	0.47051590779207	-0.47051590779207	-0.16642924645729
1.9629857854386	0.49929167249971	0.49929167249971	0.49929167249971	0.49929167249971
2.2115281129503	-0.025474206075372	0.025474206075375	0.025474206075374	-0.025474206075372
3.4784757948047	-0.023711370008879	0.0033818078234369	-0.0033818078234367	0.023711370008879
3.4784757948047	0.0033818078234369	0.02371137000888	-0.023711370008879	-0.0033818078234368
4.8228356211019	-0.011379290507122	-0.013847147451488	0.013847147451488	0.011379290507122
4.8228356211019	-0.013847147451488	0.011379290507122	-0.011379290507122	0.013847147451489
4.8482237097212	-0.0045809682901889	0.00045021740717915	-0.0004502174071792	0.0045809682901889
4.8482237097212	0.00045021740717926	0.0045809682901893	-0.0045809682901892	-0.00045021740717916
5.9864453305857	-0.0076662338240153	0.0076662338240155	0.0076662338240155	-0.0076662338240154
6.2349876580974	-0.00034562439955716	-0.0003456243995572	-0.00034562439955697	-0.00034562439955709
8.7117520273522	-2.307643669857e-05	2.2421302747129e-05	-2.2421302747106e-05	2.3076436698639e-05
8.7117520273522	2.2421302747256e-05	2.3076436698764e-05	-2.3076436698865e-05	-2.2421302747387e-05

"""
read_cluster_model_instance(solution[0], 0)
