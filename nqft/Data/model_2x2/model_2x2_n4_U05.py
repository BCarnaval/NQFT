from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('model_2x2_n4_U05', [[2, 0, 0], [0, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

            U = 0.5
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 0.5)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	0.5
t	1
tp	-0.3

GS_energy: -3.64899 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-3.64899	1
w	4	28
-0.18364645585987	0.33417302565307	-0.37069165419201	0.37069165419201	-0.33417302565307
-0.18364645585987	-0.37069165419201	-0.33417302565307	0.33417302565307	0.37069165419201
-1.4629857854386	-0.49929167249971	-0.49929167249971	-0.49929167249971	-0.49929167249971
-1.7115281129503	-0.025474206075374	0.025474206075373	0.025474206075373	-0.025474206075374
-2.9784757948047	0.016001638672788	0.017821707315467	-0.017821707315467	-0.016001638672788
-2.9784757948047	-0.017821707315467	0.016001638672788	-0.016001638672789	0.017821707315467
-4.3228356211019	0.010871085133484	0.014249605363282	-0.014249605363282	-0.010871085133484
-4.3228356211019	-0.014249605363282	0.010871085133484	-0.010871085133484	0.014249605363282
-4.3482237097212	-0.0041733173941682	0.0019420062093043	-0.0019420062093043	0.0041733173941681
-4.3482237097212	0.0019420062093045	0.0041733173941685	-0.0041733173941682	-0.0019420062093043
-5.4864453305857	-0.0076662338240152	0.0076662338240154	0.0076662338240154	-0.0076662338240151
-5.7349876580974	-0.00034562439955718	-0.00034562439955711	-0.00034562439955717	-0.00034562439955697
-8.2117520273522	1.0086837329723e-05	3.0553108847513e-05	-3.0553108847601e-05	-1.0086837329822e-05
-8.2117520273522	-3.0553108847909e-05	1.0086837329867e-05	-1.0086837329906e-05	3.0553108847895e-05
0.086277163788037	-0.36865321556965	-0.33697020745835	0.33697020745835	0.36865321556964
0.086277163788037	-0.33697020745835	0.36865321556965	-0.36865321556965	0.33697020745835
2.5629857854386	0.49929167249971	-0.49929167249971	-0.49929167249971	0.49929167249971
2.8115281129503	-0.025474206075374	-0.025474206075373	-0.025474206075373	-0.025474206075374
4.1931727245884	0.010470545534657	-0.01298117538438	0.012981175384381	-0.010470545534657
4.1931727245884	-0.012981175384381	-0.010470545534657	0.010470545534657	0.012981175384381
4.2260987595493	-0.0067127893885449	-0.010958430659968	0.010958430659968	0.0067127893885449
4.2260987595493	-0.010958430659968	0.0067127893885447	-0.0067127893885453	0.010958430659968
5.3251609851569	-0.0084063825790705	0.0056491790373157	-0.0056491790373159	0.0084063825790704
5.3251609851569	0.005649179037316	0.0084063825790706	-0.0084063825790707	-0.0056491790373159
6.5864453305857	-0.0076662338240152	-0.0076662338240154	-0.0076662338240152	-0.0076662338240152
6.8349876580974	0.00034562439955749	-0.0003456243995574	-0.00034562439955731	0.00034562439955746
8.1142239757572	6.8078198479435e-05	9.395252280015e-05	-9.395252280015e-05	-6.807819847943e-05
8.1142239757572	-9.3952522800353e-05	6.8078198479579e-05	-6.8078198479523e-05	9.3952522800274e-05

"""
read_cluster_model_instance(solution[0], 0)
