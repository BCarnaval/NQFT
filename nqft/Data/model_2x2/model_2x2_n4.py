from pyqcm import *
new_cluster_model('clus', 4, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0]], ref = 0)
lattice_model('2D_4_sites_4_fermions', [[2, 0, 0], [1, 2, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N4:S0'])
set_parameters("""

            U = 4.0
            t = 1.0
            tp = -0.3
            tpp = 0.2
            """)
set_parameter("U", 4.0)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
U	4
t	1
tp	-0.3

GS_energy: -2.10275 GS_sector: R0:N4:S0:1
GF_format: bl
mixing	0
state
R0:N4:S0	-2.10275	1
w	4	28
0.42812939952464	-0.36138205694626	-0.29103488791892	0.29103488791892	0.36138205694626
0.42812939952464	0.29103488791892	-0.36138205694626	0.36138205694626	-0.29103488791892
-0.33864686832432	-0.47603353101111	-0.47603353101111	-0.47603353101111	-0.47603353101111
-1.8027484834621	0.15105668586668	-0.15105668586668	-0.15105668586668	0.15105668586668
-2.4901060404644	-0.12939368760661	0.1293936876066	-0.12939368760661	0.12939368760661
-2.4901060404644	0.12939368760661	0.12939368760661	-0.12939368760661	-0.12939368760661
-5.5248985091847	0.0068926543351112	-0.033730456336507	0.033730456336507	-0.0068926543351115
-5.5248985091847	-0.033730456336507	-0.0068926543351115	0.0068926543351112	0.033730456336507
-5.8027484834621	-0.023565142913377	0.023565142913377	0.023565142913377	-0.023565142913377
-6.10210990617	-0.0041888952762766	0.0035145838915826	-0.0035145838915827	0.0041888952762765
-6.10210990617	0.0035145838915827	0.0041888952762767	-0.0041888952762765	-0.0035145838915827
-7.2668500985998	0.0043172963225916	0.0043172963225917	0.0043172963225916	0.0043172963225915
-9.1247573610158	0.00035601450379203	-0.00098584384697935	0.00098584384697937	-0.00035601450379223
-9.1247573610158	-0.00098584384697934	-0.00035601450379209	0.00035601450379224	0.00098584384697957
3.0975920933055	0.2811103451217	-0.39134640539577	0.39134640539577	-0.2811103451217
3.0975920933055	-0.39134640539577	-0.2811103451217	0.2811103451217	0.39134640539577
4.9386468683243	-0.47603353101111	0.47603353101111	0.47603353101111	-0.47603353101111
6.4027484834621	0.15105668586668	0.15105668586668	0.15105668586668	0.15105668586668
7.1623598542086	-0.093080226916135	-0.093080226916133	0.093080226916133	0.093080226916135
7.1623598542086	0.093080226916133	-0.093080226916135	0.093080226916135	-0.093080226916134
9.0377861635413	-0.018388319316605	0.0075270719010762	-0.0075270719010766	0.018388319316605
9.0377861635413	0.0075270719010767	0.018388319316605	-0.018388319316605	-0.0075270719010763
10.30814805428	0.00036787445807595	-0.0093713426242148	0.0093713426242153	-0.00036787445807602
10.30814805428	-0.0093713426242153	-0.00036787445807581	0.00036787445807616	0.0093713426242149
10.402748483462	0.023565142913377	0.023565142913377	0.023565142913377	0.023565142913377
11.8668500986	-0.0043172963225912	0.0043172963225913	0.0043172963225915	-0.0043172963225916
12.607856251975	0.00055074142440275	-0.0037496339607475	0.0037496339607475	-0.00055074142440261
12.607856251975	-0.0037496339607478	-0.00055074142440262	0.00055074142440281	0.0037496339607476

"""
read_cluster_model_instance(solution[0], 0)
