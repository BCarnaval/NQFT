from pyqcm import *
new_cluster_model('clus', 16, 0, generators=None, bath_irrep=False)
add_cluster('clus', [0, 0, 0], [[0, 0, 0], [1, 0, 0], [2, 0, 0], [3, 0, 0], [0, 1, 0], [1, 1, 0], [2, 1, 0], [3, 1, 0], [0, 2, 0], [1, 2, 0], [2, 2, 0], [3, 2, 0], [0, 3, 0], [1, 3, 0], [2, 3, 0], [3, 3, 0]], ref = 0)
lattice_model('model_4x4_n16_U0', [[4, 0, 0], [0, 4, 0]], None)
interaction_operator('U', band1=1, band2=1)
hopping_operator('t', [1, 0, 0], -1, band1=1, band2=1)
hopping_operator('t', [0, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tp', [-1, 1, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [2, 0, 0], -1, band1=1, band2=1)
hopping_operator('tpp', [0, 2, 0], -1, band1=1, band2=1)

try:
    import model_extra
except:
    pass
set_target_sectors(['R0:N16:S0'])
set_parameters("""

                U = 0.0
                t = 1.0
                tp = -0.3
                tpp = 0.2
                mu = -3.1
                """)
set_parameter("U", 0.0)
set_parameter("mu", -3.1)
set_parameter("t", 1.0)
set_parameter("tp", -0.3)
set_parameter("tpp", 0.2)

new_model_instance(0)

solution=[None]*1

#--------------------- cluster no 1 -----------------
solution[0] = """
mu	-3.1
t	1
tp	-0.3
tpp	0.2

GS_energy: 0 GS_sector: uncorrelated
GF_format: bl
mixing	0
state
R0	0	1
w	16	16
0.28101344029217	-0.16486134976693	-0.23546329525861	-0.23546329525861	-0.16486134976693	-0.23546329525861	-0.33456659804132	-0.33456659804132	-0.23546329525861	-0.23546329525861	-0.33456659804132	-0.33456659804132	-0.23546329525861	-0.16486134976693	-0.23546329525861	-0.23546329525861	-0.16486134976693
1.1503231964039	0.35735804377383	0.35002458260934	0.17956638083881	-9.1000346689525e-06	0.35003372829072	0.25051913357931	-6.3794081042452e-06	-0.17958420765147	0.17958420765147	6.3794081050579e-06	-0.25051913357931	-0.35003372829072	9.1000346686111e-06	-0.1795663808388	-0.35002458260934	-0.35735804377383
1.1503231964039	9.1000346690203e-06	0.17958420765147	0.35003372829072	0.35735804377383	-0.1795663808388	6.3794081050813e-06	0.25051913357931	0.35002458260935	-0.35002458260934	-0.25051913357931	-6.3794081040434e-06	0.17956638083881	-0.35735804377384	-0.35003372829072	-0.17958420765147	-9.1000346687436e-06
1.8	0	-0.35355339059326	-0.35355339059327	0	0.35355339059328	0	0	0.35355339059328	0.35355339059328	0	0	0.35355339059328	0	-0.35355339059327	-0.35355339059327	0
1.8052426512054	0.31852638123106	0.12944436810636	0.12944436810636	0.31852638123106	0.12944436810631	-0.33915963142885	-0.33915963142885	0.12944436810631	0.12944436810631	-0.33915963142884	-0.33915963142884	0.12944436810631	0.31852638123106	0.12944436810635	0.12944436810635	0.31852638123106
1.9645877514263	0.15905148510628	-0.12000621552744	0.30476957403616	-0.040105017230818	0.027829153703833	-0.51835582417924	0.13070402484146	-0.2815270205306	0.2815270205306	-0.13070402484146	0.51835582417924	-0.027829153703832	0.040105017230816	-0.30476957403616	0.12000621552744	-0.15905148510629
1.9645877514263	-0.040105017230816	-0.2815270205306	-0.027829153703834	-0.15905148510628	0.30476957403616	0.13070402484146	0.51835582417923	0.12000621552744	-0.12000621552743	-0.51835582417924	-0.13070402484146	-0.30476957403616	0.15905148510629	0.027829153703831	0.2815270205306	0.040105017230818
2.3254155956004	0.38790216597918	0.20869162706699	-0.20869162706699	-0.38790216597918	0.20869162706699	0.11147878368965	-0.11147878368965	-0.20869162706699	-0.20869162706699	-0.11147878368965	0.11147878368965	0.20869162706699	-0.38790216597918	-0.20869162706699	0.20869162706699	0.38790216597918
3.3433624532501	-0.50871176739787	0.052568246641075	0.31723936279464	-0.039384345644894	0.003784822766566	0.19524967510893	0.015116184024752	-0.31287652138632	0.31287652138632	-0.015116184024753	-0.19524967510893	-0.0037848227665656	0.039384345644895	-0.31723936279464	-0.052568246641074	0.50871176739787
3.3433624532501	0.039384345644895	0.31287652138632	0.0037848227665665	-0.50871176739787	-0.31723936279464	-0.015116184024753	0.19524967510893	0.052568246641074	-0.052568246641075	-0.19524967510893	0.015116184024752	0.31723936279464	0.50871176739787	-0.0037848227665648	-0.31287652138632	-0.039384345644894
3.8	0	-0.35355339059328	0.35355339059328	0	0.35355339059326	0	0	-0.35355339059326	-0.35355339059326	0	0	0.35355339059326	0	0.35355339059328	-0.35355339059328	0
3.8054817141729	-0.28965191582535	0.18606899353499	-0.18606899353499	0.28965191582535	0.18606899353503	0.31122086522025	-0.31122086522025	-0.18606899353503	-0.18606899353503	-0.31122086522026	0.31122086522026	0.18606899353503	0.28965191582535	-0.18606899353499	0.18606899353499	-0.28965191582535
4.8137439085024	0.34837003288583	-0.22978509993364	-0.22978509993363	0.34837003288583	-0.22978509993363	0.15177593974048	0.15177593974048	-0.22978509993363	-0.22978509993364	0.15177593974048	0.15177593974048	-0.22978509993364	0.34837003288583	-0.22978509993363	-0.22978509993364	0.34837003288583
5.6417265989197	-0.29128620705677	0.34436095897866	-0.14535032951098	-0.014247728003638	0.36026586349337	-0.3359210473278	-0.016430958957459	0.1798158519677	-0.1798158519677	0.016430958957458	0.33592104732781	-0.36026586349337	0.014247728003637	0.14535032951098	-0.34436095897866	0.29128620705677
5.6417265989197	-0.014247728003637	0.1798158519677	-0.36026586349337	0.29128620705677	-0.14535032951098	-0.016430958957458	0.33592104732781	-0.34436095897866	0.34436095897866	-0.33592104732781	0.016430958957459	0.14535032951098	-0.29128620705677	0.36026586349337	-0.1798158519677	0.014247728003638
6.7691026902267	-0.1250347043319	0.21639347133636	-0.21639347133636	0.1250347043319	0.21639347133636	-0.37511871965903	0.37511871965903	-0.21639347133636	-0.21639347133636	0.37511871965903	-0.37511871965903	0.21639347133636	0.1250347043319	-0.21639347133636	0.21639347133636	-0.1250347043319

"""
read_cluster_model_instance(solution[0], 0)
